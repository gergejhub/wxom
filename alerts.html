<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WxMonitor – Alert Guide</title>
  <link rel="stylesheet" href="assets/styles.css?v=73.guide" />
  <style>
    /* Guide page should feel like the dashboard, but must not lock the header */
    header.top{ position: static !important; top:auto !important; }
    .guide-wrap{ max-width: 1180px; margin: 18px auto 64px; padding: 0 18px; }
    .guide-hero{ display:flex; gap:14px; align-items:flex-start; justify-content:space-between; flex-wrap:wrap; margin: 10px 0 16px; }
    .guide-hero__left{ min-width: 280px; }
    .guide-title{ font-size: 34px; letter-spacing: .2px; margin: 0 0 6px; }
    .guide-sub{ opacity:.85; line-height:1.35; max-width: 78ch; }
    .guide-actions{ display:flex; gap:10px; align-items:center; }

    .guide-card{ border: 1px solid rgba(255,255,255,.10); border-radius: 18px; background: rgba(0,0,0,.22);
      box-shadow: 0 0 0 1px rgba(255,255,255,.03) inset, 0 18px 55px rgba(0,0,0,.45);
      backdrop-filter: blur(10px);
    }
    .guide-card--pad{ padding: 14px 16px; }

    .toc{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 10px; }
    .toc a{ text-decoration:none; }

    .guide-grid{ display:grid; grid-template-columns: 1.1fr .9fr; gap: 14px; align-items:start; margin-top: 12px; }
    @media (max-width: 980px){ .guide-grid{ grid-template-columns: 1fr; } }

    .guide-search{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .guide-search input{ width: min(520px, 100%); }

    .section{ margin-top: 14px; }
    .section h2{ margin: 0 0 8px; font-size: 18px; letter-spacing: .2px; }

    .acc{ border: 1px solid rgba(255,255,255,.10); border-radius: 16px; overflow:hidden; }
    .acc details{ border-top: 1px solid rgba(255,255,255,.08); }
    .acc details:first-child{ border-top: 0; }
    .acc summary{ cursor:pointer; list-style:none; padding: 12px 14px; display:flex; gap:10px; align-items:center; justify-content:space-between; }
    .acc summary::-webkit-details-marker{ display:none; }
    .acc .acc__body{ padding: 0 14px 12px; opacity:.92; }

    .pill{ display:inline-flex; gap:8px; align-items:center; padding: 6px 10px; border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      font-size: 12px;
    }
    .pill b{ font-weight: 700; }

    .kgrid{ display:grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 10px; }
    @media (max-width: 760px){ .kgrid{ grid-template-columns: 1fr; } }

    .muted{ opacity:.75; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

    .tile-tag{ display:inline-flex; gap:8px; align-items:center; padding: 6px 10px; border-radius: 999px; font-size: 12px; font-weight:700; letter-spacing:.2px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.25);
    }
    .tile-tag--lvto{ box-shadow: 0 0 0 1px rgba(255,184,0,.10) inset; }
    .tile-tag--to{ box-shadow: 0 0 0 1px rgba(255,90,90,.12) inset; }
    .tile-tag--xw{ box-shadow: 0 0 0 1px rgba(55,255,220,.10) inset; }
    .tile-tag--va{ box-shadow: 0 0 0 1px rgba(255,120,140,.10) inset; }
    .tile-tag--cold{ box-shadow: 0 0 0 1px rgba(255,215,130,.10) inset; }
    .tile-tag--core{ box-shadow: 0 0 0 1px rgba(200,140,255,.12) inset; }

    .backrow{ display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap; }

    /* Use existing dashboard controls styling for consistency */
    .q{ height: 34px; }

    /* Filtered view when searching */
    .is-hidden{ display:none !important; }
  </style>
</head>
<body>
  <header class="top">
    <div class="brand">
      <div class="brand__row">
        <div class="brand__title" id="brandTitle">Wizz Air METAR/TAF Monitor</div>
        <div class="brand__spacer"></div>
        <a class="viewpill viewpill--link" href="./" title="Back to dashboard">
          <span class="viewpill__k">DASHBOARD</span>
        </a>
        <a class="viewpill viewpill--link" href="stat/" title="Open Stats"><span class="viewpill__k">STATS</span></a>
        <a class="viewpill viewpill--link" href="alerts.html" aria-current="page" title="Alert guide"><span class="viewpill__k">GUIDE</span></a>
      </div>
      <div class="brand__sub">How alerts are triggered · OM-A / OM-B policy layer (advisory)</div>
    </div>
  </header>

  <main class="guide-wrap">
    <div class="guide-hero">
      <div class="guide-hero__left">
        <h1 class="guide-title">Alert Guide</h1>
        <div class="guide-sub">A clear, operational explanation of each dashboard KPI tile: what triggers it, which OM paragraph it is based on, and how to interpret columns such as <b>CIG</b> and <b>Score</b>.</div>
      </div>
      <div class="guide-actions">
        <a class="viewpill viewpill--link" href="#tiles" title="Jump to tiles"><span class="viewpill__k">TILES</span></a>
        <a class="viewpill viewpill--link" href="#columns" title="Jump to table columns"><span class="viewpill__k">COLUMNS</span></a>
        <a class="viewpill viewpill--link" href="#notes" title="Jump to notes"><span class="viewpill__k">NOTES</span></a>
      </div>
    </div>

    <div class="guide-grid">
      <section class="guide-card guide-card--pad">
        <div class="backrow">
          <div class="pill"><b>Tip</b><span class="muted">Use search to quickly find a tile or concept.</span></div>
          <div class="guide-search">
            <input class="q" id="guideQ" type="search" autocomplete="off" placeholder="Search in this guide (e.g. LVTO, CIG, Score, TS, RVR 125)" />
          </div>
        </div>
        <div class="toc" id="toc">
          <a class="pill" href="#concepts"><b>Core concepts</b><span class="muted">CIG, Score, VIS/RVR</span></a>
          <a class="pill" href="#colors"><b>Color legend</b><span class="muted">frames & tags</span></a>
          <a class="pill" href="#tiles"><b>Tiles</b><span class="muted">triggers & OM refs</span></a>
          <a class="pill" href="#columns"><b>Table columns</b><span class="muted">how to read</span></a>
        </div>
      </section>

      <aside class="guide-card guide-card--pad">
        <div class="pill"><b>Advisory</b><span class="muted">This dashboard is a situational awareness tool. Operational decisions remain with the flight crew and OCC procedures.</span></div>
        <div style="margin-top:10px" class="muted">If you need full detail, use <span class="mono">GUIDE</span> alongside your current OM revision and local procedures.</div>
      </aside>
    </div>

    <section class="section guide-card guide-card--pad" id="concepts" data-guide-section>
      <h2>Core concepts</h2>
      <div class="acc">
        <details open>
          <summary><span class="pill"><b>CIG</b><span class="muted">Ceiling</span></span><span class="muted">How ceiling is derived</span></summary>
          <div class="acc__body">
            <div class="muted">CIG is expressed in <b>feet AGL</b>. The dashboard derives it from the lowest of <span class="mono">BKN/OVC/VV</span> layers (METAR), and uses the worst reasonable cue in TAF (BKN/OVC/VV + TEMPO/PROB groups).</div>
            <div style="margin-top:10px" class="kgrid">
              <div class="pill"><b>Example</b><span class="mono">BKN002</span><span class="muted">→ CIG 200 ft</span></div>
              <div class="pill"><b>Trigger</b><span class="muted">e.g. CIG &lt; 500 ft (advisory)</span></div>
            </div>
          </div>
        </details>
        <details>
          <summary><span class="pill"><b>Score</b><span class="muted">0–100</span></span><span class="muted">What it means and how it is calculated</span></summary>
          <div class="acc__body">
            <div class="muted">Score is a composite severity index used for quick triage. It weights operationally relevant cues (VIS/RVR, CIG, WX, wind gusts). The displayed alert severity uses:</div>
            <div style="margin-top:8px" class="pill"><b>Combined</b><span class="mono">max(METAR, 0.85 × TAF)</span></div>
            <div style="margin-top:10px" class="kgrid">
              <div class="pill"><b>OK</b><span class="muted">&lt; 20</span></div>
              <div class="pill"><b>MED</b><span class="muted">≥ 20</span></div>
              <div class="pill"><b>HIGH</b><span class="muted">≥ 45</span></div>
              <div class="pill"><b>CRIT</b><span class="muted">≥ 70</span></div>
            </div>
          </div>
        </details>
        <details>
          <summary><span class="pill"><b>VIS/RVR</b><span class="muted">minima cues</span></span><span class="muted">How the dashboard interprets visibility and RVR</span></summary>
          <div class="acc__body">
            <div class="muted">VIS is taken from METAR visibility and relevant TAF groups. RVR is taken from METAR runway visual range groups when present. For minima cues, the dashboard highlights thresholds such as LVTO and absolute minima (advisory) based on OM-A 8.1.4.</div>
          </div>
        </details>
      </div>
    </section>

    <section class="section guide-card guide-card--pad" id="colors" data-guide-section>
      <h2>Color legend</h2>
      <div class="muted">The dashboard uses color in two different ways: <b>severity frames</b> (OK/MED/HIGH/CRIT) and <b>category tags</b> (what kind of cue you are seeing). Use this legend to interpret the visual framing at a glance.</div>

      <div style="margin-top:12px" class="kgrid">
        <div>
          <div class="pill"><b>Severity frames</b><span class="muted">row / badge framing</span></div>
          <div style="margin-top:10px" class="kgrid">
            <div class="pill pill--ok"><b>OK</b><span class="muted">Low/no operational cue</span></div>
            <div class="pill pill--med"><b>MED</b><span class="muted">Watch items (early degradation)</span></div>
            <div class="pill pill--high"><b>HIGH</b><span class="muted">Likely operational impact</span></div>
            <div class="pill pill--crit"><b>CRIT</b><span class="muted">Highest priority review</span></div>
          </div>
          <div style="margin-top:10px" class="muted">Severity is driven primarily by the composite <b>Score</b> and key minima cues (VIS/RVR, CIG, WX, gusts). It is a triage helper, not an operating decision.</div>
        </div>

        <div>
          <div class="pill"><b>Category tags</b><span class="muted">what the cue refers to</span></div>
          <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
            <span class="tag tag--eng">ENG ICE</span>
            <span class="tag tag--vis">VIS</span>
            <span class="tag tag--rvr">RVR</span>
            <span class="tag tag--cig">CIG</span>
            <span class="tag tag--gust">GUST</span>
            <span class="tag tag--wx">WX</span>
          </div>
          <div style="margin-top:10px" class="muted">Tags do not represent severity by themselves; they explain which field(s) in METAR/TAF are responsible for the highlighted cue.</div>

          <div style="margin-top:14px" class="pill"><b>OM policy tags</b><span class="muted">advisory limits</span></div>
          <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
            <span class="tag tag--stop">TO/LND PROHIB</span>
            <span class="tag tag--lvto">LVTO/LVP</span>
            <span class="tag tag--warn">MINIMA CUE</span>
          </div>
          <div style="margin-top:10px" class="muted">These tags are derived from OM-A/OM-B extracts (advisory) and are intended to help you spot conditions that typically demand special attention.</div>
        </div>
      </div>

      <div style="margin-top:14px" class="pill"><b>BASE airports</b><span class="muted">priority highlight</span></div>
      <div style="margin-top:10px" class="muted">Airports listed in <span class="mono">base.txt</span> are treated as priority. They are shown first in the tile IATA lists and displayed with a distinct highlight:</div>
      <div style="margin-top:10px" class="tile__iata"><span class="base">BUD</span><span>VIE</span><span>LTN</span></div>
    </section>

    <section class="section guide-card guide-card--pad" id="tiles" data-guide-section>
      <h2>Tiles and triggers</h2>

      <div class="acc">
        <details open data-guide-item>
          <summary><span class="tile-tag tile-tag--to">TO/LND PROHIB</span><span class="muted">Take-off / landing prohibited (policy flags)</span><span class="pill"><b>OM-A</b><span class="muted">8.3.8</span></span></summary>
          <div class="acc__body">
            <div class="muted">Triggers when any of the following is detected in METAR/TAF:</div>
            <div style="margin-top:10px" class="kgrid">
              <div class="pill"><b>Heavy precipitation (TO prohibited)</b><span class="mono">+SN +GS +SG +PL FZRA +FZRA GR +GR</span></div>
              <div class="pill"><b>Thunderstorm present</b><span class="mono">TS</span><span class="muted">(CB/TCU shown as risk cue)</span></div>
            </div>
          </div>
        </details>

        <details data-guide-item>
          <summary><span class="tile-tag tile-tag--lvto">LVTO</span><span class="muted">Low Visibility Take-Off & minima cues</span><span class="pill"><b>OM-A</b><span class="muted">8.1.4</span></span></summary>
          <div class="acc__body">
            <div class="kgrid">
              <div class="pill"><b>LVTO</b><span class="muted">RVR/VIS &lt; 550 m</span></div>
              <div class="pill"><b>LVP required</b><span class="muted">RVR &lt; 400 m</span></div>
              <div class="pill"><b>Absolute minimum RVR</b><span class="muted">RVR &lt; 125 m</span></div>
              <div class="pill"><b>Approach ban cue</b><span class="muted">Below minima at 1000 ft AAL (advisory)</span></div>
            </div>
          </div>
        </details>

        <details data-guide-item>
          <summary><span class="tile-tag tile-tag--xw">XWIND</span><span class="muted">Crosswind exceedance (runway-aware)</span><span class="pill"><b>OM-B</b><span class="muted">1.3.1</span></span></summary>
          <div class="acc__body">
            <div class="muted">Advisory flag if computed crosswind (best aligned runway) exceeds company limits. RWY condition is not available automatically; therefore the dashboard uses conservative assumptions and highlights exceedance as a cue.</div>
          </div>
        </details>

        <details data-guide-item>
          <summary><span class="tile-tag tile-tag--va">VA</span><span class="muted">Volcanic ash detected</span><span class="pill"><b>OM-A</b><span class="muted">8.3.8</span></span></summary>
          <div class="acc__body">
            <div class="muted">Flags when volcanic ash cues are detected in reports/forecasts. Visible ash avoidance remains mandatory; planning into medium/high contamination zones is prohibited (operational policy).</div>
          </div>
        </details>

        <details data-guide-item>
          <summary><span class="tile-tag tile-tag--cold">COLD CORR</span><span class="muted">Cold temperature correction reminder</span><span class="pill"><b>OM-A</b><span class="muted">8.1.2.8</span></span></summary>
          <div class="acc__body">
            <div class="muted">Reminder when OAT is ≤ 0°C: published minimum heights (MDA/DA, MSA, etc.) require cold temperature correction by the pilot (per policy; advisory).</div>
          </div>
        </details>

        <details data-guide-item>
          <summary><span class="tile-tag tile-tag--core">CRITICAL</span><span class="muted">Score-based severity (≥ 70)</span><span class="pill"><b>Dashboard</b><span class="muted">scoring</span></span></summary>
          <div class="acc__body">
            <div class="muted">CRITICAL is a quick triage state based on the composite score. Use it to prioritize review, then validate against raw METAR/TAF and operational procedures.</div>
          </div>
        </details>

        <details data-guide-item>
          <summary><span class="tile-tag tile-tag--core">VIS/RVR &lt; 300</span><span class="muted">Below CAT II cue</span><span class="pill"><b>OM-A</b><span class="muted">8.1.4</span></span></summary>
          <div class="acc__body">
            <div class="muted">Advisory cue when worst (METAR/TAF) VIS/RVR falls below 300 m (CAT II minimum RVR). Actual applicable minima depend on the specific approach/runway and approvals.</div>
          </div>
        </details>

        <details data-guide-item>
          <summary><span class="tile-tag tile-tag--core">TS / CB</span><span class="muted">Thunderstorm / convective cues</span><span class="pill"><b>OM-A</b><span class="muted">8.3.8</span></span></summary>
          <div class="acc__body">
            <div class="muted">Flags thunderstorms in METAR/TAF (<span class="mono">TS</span>) and shows convective cloud cues (<span class="mono">CB/TCU</span>). Company policy: avoid TS activity; do not take off/land if overhead or approaching.</div>
          </div>
        </details>

        <details data-guide-item>
          <summary><span class="tile-tag tile-tag--core">WIND</span><span class="muted">Gust cue</span><span class="pill"><b>Dashboard</b><span class="muted">≥ 25 kt</span></span></summary>
          <div class="acc__body">
            <div class="muted">Operational cue based on gust threshold (default ≥ 25 kt). Crosswind exceedance is handled separately in XWIND (runway-aware).</div>
          </div>
        </details>

        <details data-guide-item>
          <summary><span class="tile-tag tile-tag--core">SNOW</span><span class="muted">Snow present/forecast</span><span class="pill"><b>METAR/TAF</b><span class="muted">SN</span></span></summary>
          <div class="acc__body">
            <div class="muted">Flags when snow is present or forecast. Runway condition and braking action require additional sources (SNOWTAM/RWYCC) not automatically available here.</div>
          </div>
        </details>

        <details data-guide-item>
          <summary><span class="tile-tag tile-tag--core">ENG ICE OPS</span><span class="muted">Engine icing operations cue</span><span class="pill"><b>METAR</b><span class="muted">VIS &amp; FZFG</span></span></summary>
          <div class="acc__body">
            <div class="muted">Flags combinations associated with engine icing risk cues (e.g. very low visibility with freezing fog cues). Validate with current procedures and actual surface conditions.</div>
          </div>
        </details>
      </div>
    </section>

    <section class="section guide-card guide-card--pad" id="columns" data-guide-section>
      <h2>Table columns</h2>
      <div class="acc">
        <details open data-guide-item>
          <summary><span class="pill"><b>Airport</b></span><span class="muted">IATA / ICAO</span></summary>
          <div class="acc__body"><div class="muted">Shows ICAO plus mapped IATA (when available). BASE airports are highlighted and prioritized in tiles.</div></div>
        </details>
        <details data-guide-item>
          <summary><span class="pill"><b>Triggers</b></span><span class="muted">Why it fired</span></summary>
          <div class="acc__body"><div class="muted">Badges show the exact trigger cues detected in METAR/TAF.</div></div>
        </details>
        <details data-guide-item>
          <summary><span class="pill"><b>Worst VIS</b></span><span class="muted">Worst visibility + trend</span></summary>
          <div class="acc__body"><div class="muted">Shows the worst visibility considering METAR and relevant TAF groups; trend arrow is a short-horizon cue.</div></div>
        </details>
        <details data-guide-item>
          <summary><span class="pill"><b>RVR / Ceiling / Ages</b></span><span class="muted">Operationally relevant fields</span></summary>
          <div class="acc__body"><div class="muted">RVR when reported, CIG derived in ft, ages show freshness of METAR (M) and TAF (T).</div></div>
        </details>
      </div>
    </section>

    <section class="section guide-card guide-card--pad" id="notes" data-guide-section>
      <h2>Notes</h2>
      <div class="muted">This guide intentionally avoids requiring manual runway headings or runway contamination inputs. Some policy elements (e.g., RWYCC, braking action, SNOWTAM) require additional sources and remain out of scope for automatic parsing here.</div>
      <div style="margin-top:12px" class="backrow">
        <a class="viewpill viewpill--link" href="./" title="Back to dashboard"><span class="viewpill__k">BACK</span></a>
        <span class="muted">Last updated with the dashboard build.</span>
      </div>
    </section>
  </main>

  <script>
    // Lightweight in-page search (no dependencies)
    (function(){
      const q = document.getElementById('guideQ');
      if(!q) return;
      const sections = Array.from(document.querySelectorAll('[data-guide-section]'));
      const items = Array.from(document.querySelectorAll('[data-guide-item]'));
      const norm = (s)=>String(s||'').toLowerCase();
      const apply = ()=>{
        const term = norm(q.value).trim();
        if(!term){
          items.forEach(el=>el.classList.remove('is-hidden'));
          sections.forEach(el=>el.classList.remove('is-hidden'));
          return;
        }
        // filter details blocks first
        items.forEach(el=>{
          const text = norm(el.textContent);
          el.classList.toggle('is-hidden', !text.includes(term));
        });
        // hide entire section if all its items are hidden
        sections.forEach(sec=>{
          const its = Array.from(sec.querySelectorAll('[data-guide-item]'));
          if(!its.length){
            sec.classList.toggle('is-hidden', !norm(sec.textContent).includes(term));
            return;
          }
          const anyVisible = its.some(x=>!x.classList.contains('is-hidden'));
          sec.classList.toggle('is-hidden', !anyVisible);
        });
      };
      q.addEventListener('input', apply);
    })();
  </script>
</body>
</html>
